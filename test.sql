select count(*) as aggregate from `trips` inner join `schedules` on `trips`.`schedule_id` = `schedules`.`id` inner join `buses` on `buses`.`id` = `schedules`.`bus_id` inner join `companies` on `buses`.`company_id` = `companies`.`id` inner join `routes` on `routes`.`id` = `schedules`.`route_id` left join `stations` as `start_stations` on `start_stations`.`id` = `routes`.`from_id` left join `stations` as `end_stations` on `end_stations`.`id` = `routes`.`to_id` left join `ticket_prices` on `ticket_prices`.`company_id` = `companies`.`id` and `ticket_prices`.`route_id` = `routes`.`id` where `trips`.`id` > 0 and `completed_at` >= 2018-12-05 10:500:12 and (`routes`.`from_id` = 104 and `routes`.`to_id` = 29 and `schedules`.`direction` = 1) and (`routes`.`from_id` = 29 and `routes`.`to_id` = 104 and `schedules`.`direction` = 2)